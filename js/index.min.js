var GISApp={$:function(t,i){var a=null;var n=i||document;if(t==null||t===""){return}if(/^#/.test(t)){a=document.getElementById(t.substring(1))}else if(/^\./.test(t)){a=n.getElementsByClassName(t.substring(1))}else if(/^\w+$/.test){a=n.getElementsByTagName(t)}else if(t==="*"){a=n.getElementsByTagName("*")}else if(/^</.test(t)){a=document.createElement(t.substring(1,t.indexOf(">")))}return a},utils:{Sleeper:function(){var self=this;self.step=0;self.actions=[];self.push=function(t,i){if(typeof i=="undefined"){i=0}self.actions.push([t,i]);return self};self.run_next=function(){if(self.step<self.actions.length){var action=self.actions[self.step],fn=action[0],time=action[1];if(typeof fn=="function"){fn()}else{eval(fn)}++self.step;setTimeout(self.run_next,time)}};self.run=function(){self.run_next()};return self},getRandom:function(t,i){if(parseInt(t)!==t||parseInt(i)!==i){return}return t+Math.floor(Math.random()*(i-t+1))},getRandomColor:function(){var t=this.getRandom(0,255),i=this.getRandom(0,255),a=this.getRandom(0,255);return"rgb("+t+","+i+","+a+")"}},divId:"allmap",zoomRange:{minZoom:1,maxZoom:19},spotsCoordinate:{southDoor:{lng:108.912327,lat:34.373761},library:{lng:108.91106,lat:34.37665},mingyuanLake:{lng:108.910256,lat:34.374491},xiuyuanLake:{lng:108.907638,lat:34.373634},zilanYuan:{lng:108.905617,lat:34.375139},shuhuiYuan:{lng:108.915853,lat:34.377694},gym:{lng:108.917604,lat:34.380401},carExperimentalField:{lng:108.908603,lat:34.378468}},allSpotsInfo:{southdoor:{title:"长安大学",imgSrc:"http://files.eduuu.com/img/2014/11/13/144452_546453643f406.jpg",imgTitle:"长安大学南门",imgId:"southdoor",info:"长安大学（Chang’an University）座落于古都西安，是中华人民共和国教育部直属的全国重点大学，由教育部和交通运输部、国土资源部、住房和城乡建设部、陕西省人民政府“四部一省”共建，是国家首批“211工程”、“985工程优势学科创新平台”、“111计划”、国家建设高水平大学公派研究生项目”和“卓越工程师教育培养计划”重点建设高校。"},library:{title:"逸夫图书錧",imgSrc:"http://1813.img.pp.sohu.com.cn/images/blog/2008/9/18/23/27/11d1d12b3a5g215.jpg",imgTitle:"逸夫图书錧",imgId:"library",info:"长安大学逸夫图书馆位于长安大学渭水校区，共13层，约45000平方米，是渭水新校区的重要标志，也是长安大学的标志，逸夫图书馆气势恢宏，是长安大学各个校区图书馆最高大的一个，2至5层为图书借阅室，6至8层为自习室。馆内学习资源丰富，各种学习设施齐全，是学习钻研的好去处。"},mingyuanLake:{title:"明远湖",imgSrc:"http://i3.s1.dpfile.com/2011-08-16/9163507_b.jpg%28249x249%29/thumb.jpg",imgTitle:"明远湖",imgId:"mingyuanLake",info:"明远湖的夜晚，则是有着昏黄的灯光，道路变得很是柔软。有朦胧的雾气连接着湖面，显得甚是奇幻。水中的鱼儿都枕着水草入睡，杨柳也低垂着面庞。一切都跟童话里的插图一个样。当我走得困倦，我就躺下来，倚靠在亭子上。当你靠在亭子上时，你又有了一些念想。"},xiuyuanLake:{title:"修远湖",imgSrc:"http://f.hiphotos.baidu.com/zhidao/pic/item/8601a18b87d6277f4b94390c2b381f30e924fc04.jpg",imgTitle:"修远湖",imgId:"mingyuanLake",info:"蛇形石路皆以疏散圆石铺成，滑而坎坷，虽欲疾速前往，却感力不从心。浓浓诗意，油然而生。水声清脆，渐闻渐近。迎面松柳，犬牙交错。坎坎小路，曲折萦回。参差树木，渐远而去。绿色湖面，宽阔朦胧，滴滴点点现于犬齿之隙。步行数步，林路双尽，豁然开朗。绿水之面，波光粼粼，悉数鸟雀，飞于其上，忽而行止于空，忽而疾行而下，萦绕空中。阶梯河床之上，潺潺绿流，缓缓流下。湖畔垂柳随细风细心摆弄枝尖，婀娜身姿，配以细条嫩叶、鸣啼之鸟，衬于修远湖之列。修远湖之景，其景之佳，使观者神清气爽，悠然自得。"},zilanYuan:{title:"滋兰苑",imgSrc:"http://zsb.chd.edu.cn/edit/UploadFile/2010524151950363.jpg",imgTitle:"滋兰苑",imgId:"zilanYuan",info:"西区食堂, 环境优雅"},shuhuiYuan:{title:"树蕙园",imgSrc:"http://2b.zol-img.com.cn/product/76_500x2000/569/ceXav8z4L7iOs.jpg",imgTitle:"树蕙园",imgId:"shuhuiYuan",info:"东区食堂, 环境优雅,美食多多."},gym:{title:"体育錧",imgSrc:"http://img5.imgtn.bdimg.com/it/u=2635758037,3180852368&fm=21&gp=0.jpgg",imgTitle:"渭水校区体育錧",imgId:"gym",info:"同学们跑步,踢球的好地方"},carExperimentalField:{title:"汽车实验场",imgSrc:"http://imgsrc.baidu.com/forum/w%3D580/sign=ce90c9e58e5494ee87220f111df4e0e1/cc6244e736d12f2e8476e63a4dc2d56284356883.jpg",imgTitle:"长安大学汽车实验场",imgId:"carExperimentalField",info:"长安大学汽车试验场是中国高校唯一的汽车综合性能试验基地，占地423亩，总投资近6000万元，是国家“211工程”重点投资建设项目。拥有全长2.4km的汽车高速环形跑道、1.1km直线试车道、五种可靠性强化典型试验道路、13000m2的操纵稳定性试验广场、三种低附着系数组合路面。"}},initScaleLevel:19,city:"西安",map:null,init:function(){this.map=new BMap.Map("allmap",this.zoomRange);var t=this.map;t.centerAndZoom(new BMap.Point(this.spotsCoordinate.southDoor.lng,this.spotsCoordinate.southDoor.lat),this.initScaleLevel);t.addControl(new BMap.MapTypeControl);t.setCurrentCity(this.city);t.addControl(new BMap.OverviewMapControl({size:new BMap.Size(150,150),isOpen:true}))},moveMap:function(t,i){if(!t){throw new Error("Please give effective parameters!")}var a=t.getCenter(),n=i.dest,e=parseInt(i.totalTime/i.interval),o=i.callback,l=n.lng-a.lng,s=n.lat-a.lat,r={toLeft:l<0,toUp:s>0},p=(Math.abs(l)/e).toFixed(6),u=(Math.abs(s)/e).toFixed(6);var m=setInterval(function(){if(e--<=0){clearInterval(m);if(typeof o==="function"){o(t)}}if(r.toLeft){a.lng=parseFloat(a.lng)-parseFloat(p)}else{a.lng=parseFloat(a.lng)+parseFloat(p)}if(r.toUp){a.lat=parseFloat(a.lat)+parseFloat(u)}else{a.lat=parseFloat(a.lat)-parseFloat(u)}t.panTo(new BMap.Point(a.lng,a.lat))},i.interval)},buildInfoWindow:function(t){var i=t.title,a=t.imgSrc,n=t.imgTitle,e=t.imgId,o=t.info;return'<div class="info-of-spots">'+"<h4>"+i+"</h4>"+'<img id="'+e+'" src="'+a+'" title="'+n+'"/> '+"<p>"+o+"</p>"+"</div>"},displayInfo:function(t){var i={position:"absolute",left:0,top:0,backgroundColor:"#fff",opacity:.1};var a=this.buildInfoWindow(t);var n=document.createElement("div");n.innerHTML=a;var e=n.childNodes[0];e.id="display";for(var o in i){if(i.hasOwnProperty(o)){e.style[o]=i[o]}}this.$("body")[0].appendChild(e);var l=setInterval(function(){if(parseFloat(e.style.opacity)>=1){e.style.opacity=1;clearInterval(l)}e.style.opacity=parseFloat(e.style.opacity)+.05},100)},buildBasicMarker:function(t,i){var a=new BMap.Point(i.point.lng,i.point.lat);var n=new BMap.Marker(a);var e=i.animationType||BMAP_ANIMATION_BOUNCE;t.addOverlay(n);n.setAnimation(e);return n},buildWnd:function(t,i){var a=this.buildBasicMarker(t,i.markerObj);var n=this.buildInfoWindow(i.infoObj);var e=new BMap.InfoWindow(n);t.addOverlay(a);a.addEventListener("load",function(){e.redraw()},false);a.addEventListener("click",function(){})},markSouthDoor:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.southDoor},infoObj:this.allSpotsInfo.southdoor})},markLibrary:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.library},infoObj:this.allSpotsInfo.library})},markMingyuanLake:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.mingyuanLake},infoObj:this.allSpotsInfo.mingyuanLake})},markZilanYuan:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.zilanYuan},infoObj:this.allSpotsInfo.zilanYuan})},markShuhuiYuan:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.shuhuiYuan},infoObj:this.allSpotsInfo.shuhuiYuan})},markGym:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.gym},infoObj:this.allSpotsInfo.shuhuiYuan})},markCarExperimentalField:function(){this.buildWnd(this.map,{markerObj:{point:this.spotsCoordinate.carExperimentalField},infoObj:this.allSpotsInfo.carExperimentalField})},travel:function(){var t=this;window.addEventListener("load",function(){var i=new t.utils.Sleeper;i.push(function(){t.init();t.markSouthDoor();t.displayInfo(t.allSpotsInfo.southdoor)},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.library,interval:100,totalTime:5e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.library);document.title=t.allSpotsInfo.library.title}});t.markLibrary()},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.mingyuanLake,interval:100,totalTime:5e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.mingyuanLake);document.title=t.allSpotsInfo.mingyuanLake.title}});t.markMingyuanLake()},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.zilanYuan,interval:100,totalTime:4e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.zilanYuan);document.title=t.allSpotsInfo.zilanYuan.title}});t.markZilanYuan()},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.shuhuiYuan,interval:100,totalTime:5e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.shuhuiYuan);document.title=t.allSpotsInfo.shuhuiYuan.title}});t.markShuhuiYuan()},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.gym,interval:100,totalTime:4e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.gym);document.title=t.allSpotsInfo.gym.title}});t.markGym()},1e4).push(function(){t.moveMap(t.map,{dest:t.spotsCoordinate.carExperimentalField,interval:100,totalTime:5e3,callback:function(){t.$("body")[0].removeChild(t.$("#display"));t.displayInfo(t.allSpotsInfo.carExperimentalField);document.title=t.allSpotsInfo.carExperimentalField.title;setTimeout(function(){document.title="渭水长安景点导航";t.$("body")[0].removeChild(t.$("#display"));t.map.clearOverlays();t.map.setZoom(6);t.buildBasicMarker(t.map,{point:t.spotsCoordinate.library})},2e3)}});t.markCarExperimentalField()},1e4).push(function(){var i=t.$("#roll"),a=i.getElementsByTagName("span"),n=a.length,e=0,o=null;i.style.display="block";var l=setInterval(function(){o=a.item(e);o.style.visibility="visible";o.style.color=t.utils.getRandomColor();++e;if(e>=n){clearInterval(l)}},800)},2e3).run()},false)},start:function(){this.travel()}};GISApp.start();
